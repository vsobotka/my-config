---
######## Git
- name: Install Git
  become: yes
  pacman: name=git state=present

- name: Create Git config symlink
  file:
    src: '{{ playbook_dir }}/roles/common/files/.gitconfig'
    dest: ~/.gitconfig
    state: link

######## NeoVim
- name: Install NeoVim
  become: yes
  pacman: name=neovim state=present

- name: Check NeoVim config dir state
  stat: path=~/.config/nvim
  register: nvim

- name: Remove NeoVim config if it is a dir
  file: path=~/.config/nvim state=absent
  when: nvim.stat.isdir is defined and nvim.stat.isdir

- name: Create NeoVim config symlink
  file:
    src: '{{ playbook_dir }}/roles/common/files/nvim'
    dest: ~/.config/nvim
    state: link
    force: yes

######## Bash aliases
- name: Create symlink to .bash_aliases
  file:
    src: '{{ playbook_dir }}/roles/common/files/.bash_aliases'
    dest: ~/.bash_aliases
    state: link
    force: yes

- name: Source .bash_aliases from .bashrc
  lineinfile:
    path: ~/.bashrc
    line: source ~/.bash_aliases
    state: present

######## Docker and docker-compose
- name: Ensure docker is installed
  become: yes
  pacman: name=docker state=latest

- name: Ensure docker-compose is installed
  become: yes
  pacman: name=docker-compose state=latest

- name: Ensure Docker daemon is started and enabled
  become: yes
  service:
    name: docker
    enabled: yes
    state: started

- name: Ensure docker group exists
  group:
    name: docker
    state: present

- name: Ensure user vsobotka is int he docker group
  become: yes
  user:
    user: vsobotka
    groups: docker
    append: yes

